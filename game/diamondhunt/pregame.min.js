/*! tweensoft.com 2014-07-15 16:26:45 */
function main(){language="en",document.bgColor="#222",global_pause=!1,devise_size=window.innerWidth*window.devicePixelRatio<=320||window.innerHeight*window.devicePixelRatio<=372?1:2,game_area=document.getElementById("game_area"),canvas=document.getElementById("my_canvas"),canvas.width=320*devise_size,canvas.height=480*devise_size,stage=new createjs.Stage(canvas),stage.mouseMoveOutside=!0,createjs.Touch.enable(stage),void 0!==window.orientation&&(rotate=document.createElement("img"),rotate.id="img_rotate",rotate.src="assets/rotate.jpg",rotate.unselectable="on",document.body.appendChild(rotate)),load=new ClassLoad,ResizeWindow(),window.addEventListener("resize",ResizeWindow,!1)}function StartGame(){config.add_score=[];for(var a=1;a<config.score.length+1;a++)config.add_score[Math.pow(2,a)]=config.score[a-1];save=new ClassSave,game=new ClassGame,windows=new ClassWindows,windows.Show("main_menu"),createjs.Ticker.setFPS(30),createjs.Ticker.addEventListener("tick",Drw)}function Drw(){global_pause||(windows.Drw(),stage.update())}function ResizeWindow(){Resize(window.innerWidth,window.innerHeight)}function Resize(a,b){if(document.body.style.height=(2*window.innerHeight<<0)+"px",window.scrollTo(0,1),width=a,height=b,void 0!=rotate&&width>height){document.bgColor="#fff";var c=Math.min(height,Math.min(width,400));game_area.style.display="none",rotate.style.display="block",rotate.style.height=c+"px",rotate.style.width=c+"px",rotate.style.marginLeft=c/-2+"px",rotate.style.marginTop=c/-2+"px"}else{document.bgColor="#222";var d=width/height,e=640/744;d>=e?(width=height*(640/744),height=height/744*960):height=width/(640/960),void 0!=rotate&&(rotate.style.display="none"),game_area.style.display="block",game_area.style.width=(width<<0)+"px",game_area.style.height=(height<<0)+"px",game_area.style.marginLeft=(-width/2<<0)+"px",game_area.style.marginTop=(-height/2<<0)+"px"}}function ClassLoad(){this.queue=new createjs.LoadQueue(!0),this.queue.loadManifest([{id:"bg_window",src:"assets/bg_window"+devise_size+".jpg",type:createjs.LoadQueue.IMAGE},{id:"loading",src:"assets/loading"+devise_size+".png",type:createjs.LoadQueue.IMAGE},{id:"loading_shape",src:"assets/loading_shape"+devise_size+".png",type:createjs.LoadQueue.IMAGE}]),this.queue.addEventListener("complete",function(){load.Start()},!1)}var game_area,canvas,stage,rotate,devise_size,width,height,global_pause,language,load,windows,game,save,addToHomeConfig={autostart:!1};!function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/all.js",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk"),ClassLoad.prototype.Start=function(){this.img_load=new createjs.Bitmap(this.queue.getResult("bg_window")),stage.addChild(this.img_load);var a=new createjs.Bitmap(load.queue.getResult("loading"));a.regX=112*devise_size,a.regY=81*devise_size,a.x=160*devise_size,a.y=240*devise_size,stage.addChild(a),this.progress=new createjs.Bitmap(load.queue.getResult("loading_shape")),this.progress.regX=15*devise_size,this.progress.regY=15*devise_size,this.progress.x=60*devise_size,this.progress.y=305*devise_size,stage.addChild(this.progress),this.queue.removeAllEventListeners("complete"),this.queue.addEventListener("complete",function(){load.EndLoad()},!1),this.queue.addEventListener("progress",function(){load.Upd()},!1),this.queue.loadManifest([{id:"bg_menu",src:"assets/bg_menu"+devise_size+".jpg",type:createjs.LoadQueue.IMAGE},{id:"bg_game",src:"assets/bg_game"+devise_size+".jpg",type:createjs.LoadQueue.IMAGE},{id:"logo",src:"assets/logo"+devise_size+".png",type:createjs.LoadQueue.IMAGE},{id:"pack",src:"assets/pack"+devise_size+".png",type:createjs.LoadQueue.IMAGE},{id:"font0",src:"assets/fonts/font0"+devise_size+".png",type:createjs.LoadQueue.IMAGE},{id:"font1",src:"assets/fonts/font1"+devise_size+".png",type:createjs.LoadQueue.IMAGE},{id:"font2",src:"assets/fonts/font2"+devise_size+".png",type:createjs.LoadQueue.IMAGE},{id:"config",src:"js/config.js",type:createjs.LoadQueue.JAVASCRIPT},{id:"data",src:"assets/data"+devise_size+".js",type:createjs.LoadQueue.JAVASCRIPT},{id:"fonts",src:"assets/fonts/fonts"+devise_size+".js",type:createjs.LoadQueue.JAVASCRIPT},{id:"game",src:"game.min.js",type:createjs.LoadQueue.JAVASCRIPT}])},ClassLoad.prototype.Upd=function(){this.progress.x=(60+200*this.queue.progress)*devise_size,stage.update()},ClassLoad.prototype.EndLoad=function(){stage.removeAllChildren(),CreateFonts(),StartGame()},ClassLoad.prototype.LoadAudio=function(){lock_audio&&(lock_audio=!1,createjs.Sound.registerPlugins([createjs.WebAudioPlugin]),audio_supported=createjs.WebAudioPlugin.isSupported(),audio_supported&&(createjs.Sound.alternateExtensions=["ogg"],this.queue.installPlugin(createjs.Sound),this.queue.removeAllEventListeners(),this.queue.addEventListener("complete",MusicPlay,!1),this.queue.loadManifest([{id:"pop",src:"assets/audio/pop.mp3",type:createjs.LoadQueue.SOUND},{id:"music",src:"assets/audio/music.mp3",type:createjs.LoadQueue.SOUND}])))},document.onkeydown=function(a){game.move&&"loc"==windows.getPrevious(0)&&(87==a.keyCode&&game.grid.Up(),65==a.keyCode&&game.grid.Left(),83==a.keyCode&&game.grid.Down(),68==a.keyCode&&game.grid.Right())};